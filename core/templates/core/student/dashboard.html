{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Your Assessments</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'core/css/dashboard.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }

        .status-ready {
            color: green;
            font-weight: bold;
        }

        .status-submitted {
            color: orange;
            font-weight: bold;
        }

        .status-closed {
            color: red;
            font-weight: bold;
        }

        .btn-disabled {
            pointer-events: none;
            opacity: 0.6;
        }


        .main-content {
            flex: 1;
            margin-left: 280px;
            padding: 30px;
            background-color: #efeaea;
            background-image: url("{% static 'core/images/Frame.png' %}");
            background-repeat: no-repeat;
            background-size: cover;
            opacity: 0.9;
        }

        .sidebar {
            width: 280px;
            background: linear-gradient(to bottom, #f1f1f1, white, #e0e0e0, #f5f5f5, #3c1c53);
            padding: 20px;
            color: var(--dark-purple);
            border-right: 1px solid var(--gold);
            position: fixed;
            height: 100%;
            overflow-y: auto;
        }

        .sidebar-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .sidebar-header img {
            max-width: 50%;
            margin-bottom: 15px;
        }

        .sidebar-header h4 {
            color: var(--dark-purple);
            font-weight: 600;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu li a {
            display: block;
            padding: 10px 15px;
            color: var(--dark-purple);
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
        }

        .sidebar-menu li.active a {
            background-color: var(--dark-purple);
            color: white;
        }

        .sidebar li {
            margin-bottom: 10px;
            /* optional spacing between items */
        }

        .sidebar li a:hover {
            background: #613085;
            color: white;
        }

        .sidebar ul {
            list-style-type: none;
            padding-left: 0;
            /* removes default padding */
        }
    </style>
</head>

<body>

    <div class="sidebar">
        <div class="sidebar-header">
            <img src="{% static 'core/images/logo_simplebbbbbbbbbbbbbb.png' %}" alt="CHIETA Logo">
        </div>
        <ul class="sidebar-menu">
            <li class="active"><a href="{% url 'student_dashboard' %}"><i class="fas fa-check-square"></i>
                    Assessments</a></li>

            <li><a href="#" class="{% if request.resolver_match.url_name == 'qcto_compliance' %}active{% endif %}"><i
                        class="fas fa-clipboard-check"></i> Results</a></li>
            <li><a href="{% url 'logout' %}"><i class="logout fas fa-sign-out-alt"></i> Log Out</a></li>
        </ul>
        <img src="{% static 'core/images/rb_2149331949.png' %}" alt="Sidebar Art" width="199px">
        <li class="active"><a href="{% url 'papers_demo' %}"><i class="fas fa-check-square"></i> Write Paper</a></li>

    </div>




    <div class="main">
        <div class="main-content">
            <div class="welcome-container">
                <div class="image-container">
                    <!-- <img src="{% static 'core/images/rb_2148892786.png' %}" alt="Profile Picture" width="390px" height="190px"> -->
                </div>
                <div class="welcome-box">
                    <h2>Student Dashboard</h2>

                    <button class="gradient-button">Innovating for Impact</button>
                </div>
            </div>
            <h2 class="mb-4 text-center">Your Assessments</h2>

            {% if assessment_data %}
            <table class="table table-bordered table-hover align-middle">
                <thead class="table-dark">
                    <tr>
                        <th>EISA ID</th>
                        <th>Qualification</th>
                        <th>Questions</th>
                        <th>Status</th>
                        <th>Attempt</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in assessment_data %}
                    {% with assessment=item.assessment attempt=item.attempt %}
                    <tr>
                        <td>{{ assessment.eisa_id }}</td>
                        <td>{{ assessment.get_qualification_display }}</td>
                        <td>{{ assessment.generated_questions.count }}</td>
                        <td class="status-{{ assessment.status|lower|slugify }}">{{ assessment.status }}</td>
                        <td>{{ attempt }}</td>
                        <td>
                            {% if attempt < 3 %} <a href="{% url 'student_assessment' assessment.id %}"
                                class="btn btn-success">
                                Write Paper
                                </a>
                                {% else %}
                                <button class="btn btn-secondary btn-disabled" disabled>Max Attempts</button>
                                {% endif %}
                        </td>
                    </tr>
                    {% endwith %}
                    {% endfor %}
                </tbody>
            </table>
            {% else %}
            <div class="alert alert-warning text-center">No assessments available for your qualification yet.</div>
            {% endif %}

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>