{% load static %} {% load widget_tweaks %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload EISA Tool | CHIETA</title>
  <!-- Global CSS -->
  <link rel="stylesheet" href="{% static 'core/css/dashboard.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
   select#qualification {
    appearance: auto !important;            /* Just some forceful css to make text visible, it can be removed, its a failsafe incase something happens to the js */
    -webkit-appearance: auto !important;    
    background-color: #fff !important;     
    color: #000 !important;                 
    -webkit-text-fill-color: #000 !important; 
    font-size: 1rem !important;             
    border: 1px solid #ccc !important;      
    border-radius: 4px !important;
    padding: .5em !important;
    z-index: 1000;                          
    position: relative;}

  </style>
</head>
<body>  
  {% if messages %}
  {% for message in messages %}
    <div class="alert alert-success">{{ message }}</div>
  {% endfor %}
{% endif %}

  <div class="dashboard-container">
    <div class="sidebar">
      <div class="graduate-icon">
        <a href="{% url 'assessor_dashboard' %}">
          <img src="{% static 'core/images/logo_simplebbbbbbbbbbbbbb.png' %}" alt="CHIETA Logo">
        </a>
      </div>

      <ul class="sidebar-nav">
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'assessor_dashboard' %} active{% endif %}"
             href="{% url 'assessor_dashboard' %}">
            <i class="fa fa-home"></i>
            <span>Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'upload_assessment' %} active{% endif %}"
             href="{% url 'upload_assessment' %}">
            <i class="fa fa-upload"></i>
            <span>Upload Assessment</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'generate_tool_page' %} active{% endif %}"
             href="{% url 'generate_tool_page' %}">
            <i class="fa fa-cogs"></i>
            <span>Generate Assessment</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'assessment_archive' %} active{% endif %}"
             href="{% url 'assessment_archive' %}">
            <i class="fa fa-archive"></i>
            <span>Assessment History</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'assessor_reports' %} active{% endif %}"
             href="{% url 'assessor_reports' %}">
            <i class="fa fa-chart-bar"></i>
            <span>Reports</span>
          </a>
        </li>

        <!-- Placeholder items (Notifications / Help) -->
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="fa fa-bell"></i>
            <span>Notifications</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="fa fa-life-ring"></i>
            <span>Help &amp; Support</span>
          </a>
        </li>

        <!-- Settings / Logout Buttons -->
        <li class="nav-item mt-4">
          <button class="gradient-button w-100">
            <i class="fa fa-cog"></i>
            <span>Settings</span>
          </button>
        </li>
        <li class="nav-item mt-2">
          <button class="gradient-button w-100">
            <i class="fa fa-sign-out-alt"></i>
           <a href="{% url 'logout' %}" class="fix">üö™ Log Out</a><br>
          </button>
        </li>
      </ul>

      <div class="sidebar-footer">
        <img src="{% static 'core/images/rb_2149331949.png' %}" alt="Sidebar Art">
      </div>
    </div>

    <div class="content p-4">
      <div class="welcome-container">
        <div class="image-container">
          <img src="{% static 'core/images/rb_2148892786.png' %}" alt="Profile Picture" width="390" height="190">
        </div>
        <div class="welcome-box">
          <h2>Upload EISA Assessment Tool</h2>
          <div class="date">Generate EISA assessments tools using the Databank</div>
          <button class="gradient-button">Innovating for Impact</button>
        </div>
      </div>

      
<form id="uploadForm" action="{% url 'upload_assessment' %}" method="post" enctype="multipart/form-data">
  {% csrf_token %}

  <div class="form-section">
  <label for="qualification">Qualification</label>
<select id="qualification" name="qualification" required>
  <option value="">-- Select Qualification --</option>
  {% for qual in qualifications %}
    <option value="{{ qual.id }}"
      {% if request.POST.qualification == qual.id|stringformat:"s" %}
        selected
      {% endif %}>
      {{ qual.name }}
    </option>
  {% endfor %}
</select>

  </div>

  <div class="form-section">
    <label for="paperNumber">Paper Number</label>
    <input type="text" id="paperNumber" name="paper_number" placeholder="e.g. 1A, 1B" required>
  </div>

  <div class="form-section">
    <label for="saqaID">SAQA ID</label>
    <input type="text" id="saqaID" name="saqa_id" placeholder="e.g. 123456" required>
  </div>

  <div class="form-section">
    <label for="fileInput">Upload EISA Assessment</label>
    <input type="file" id="fileInput" name="file_input" accept=".pdf,.doc,.docx required>
  </div>

  <div class="form-section">
    <label for="memoFile">Upload Memo</label>
    <input type="file" id="memoFile" name="memo_file">
  </div>

  <div class="form-section">
    <label for="commentBox">Comment (Optional)</label>
    <textarea id="commentBox" name="comment_box" rows="3" placeholder="Write any notes..."></textarea>
  </div>

  <div class="form-section form-checkbox">
    <input type="checkbox" id="forwardToModerator" name="forward_to_moderator">
    <label for="forwardToModerator">Forward this assessment directly to Moderator</label>
  </div>

  <div class="form-section">
    <button type="submit" class="gradient-button">Submit Upload</button>
  </div>
</form>

<section class="submitted-section">
  <h3>Submitted Assessments</h3>
  <table class="assessment-table">
    <thead>
      <tr>
        <th>EISA ID</th>
        <th>Qualification</th>
        <th>Paper</th>
        <th>Status</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody>
      {% for a in submissions %}
        <tr>
          <td><strong>{{ a.eisa_id }}</strong></td>
          <td>{{ a.qualification }}</td>
          <td>{{ a.paper }}</td>
          <td>{{ a.status }}</td>
          <td>
            <a href="{% url 'view_assessment' a.eisa_id %}"
               class="gradient-button small">
              ‚úèÔ∏è View/Edit
            </a>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="5" style="text-align:center;">
            No assessments submitted yet.
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</section>

    </div>
  </div>
</body>
</html>