{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Assessor Dashboard | CHIETA</title>

  <!-- Dashboard CSS -->
  <link rel="stylesheet" href="{% static 'core/css/dashboard.css' %}">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
</head>
<body>
  <div class="dashboard-container">

    <!-- ======================= -->
    <!-- ====== SIDEBAR ======= -->
    <!-- ======================= -->
    <div class="sidebar">
      <div class="graduate-icon">
        <a href="{% url 'assessor_dashboard' %}">
          <img src="{% static 'core/images/logo_simplebbbbbbbbbbbbbb.png' %}" alt="CHIETA Logo">
        </a>
      </div>

      <ul class="sidebar-nav">
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'assessor_dashboard' %} active{% endif %}"
             href="{% url 'assessor_dashboard' %}">
            <i class="fa fa-home"></i>
            <span>Dashboard</span>
          </a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'generate_tool_page' %} active{% endif %}"
             href="{% url 'generate_tool_page' %}">
            <i class="fa fa-cogs"></i>
            <span>Generate Assessment</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'assessment_archive' %} active{% endif %}"
             href="{% url 'assessment_archive' %}">
            <i class="fa fa-archive"></i>
            <span>Assessment History</span>
          </a>
        </li>
        <!-- <li class="nav-item">
          <a class="nav-link{% if request.resolver_match.url_name == 'assessor_reports' %} active{% endif %}"
             href="{% url 'assessor_reports' %}">
            <i class="fa fa-chart-bar"></i>
            <span>Reports</span>
          </a>
        </li> -->

        <!-- Placeholder items (Notifications / Help) -->
        <!-- <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="fa fa-bell"></i>
            <span>Notifications</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">
            <i class="fa fa-life-ring"></i>
            <span>Help &amp; Support</span>
          </a>
        </li> -->

        <!-- Settings / Logout Buttons -->
        <!-- <li class="nav-item mt-4">
          <button class="gradient-button w-100">
            <i class="fa fa-cog"></i>
            <span>Settings</span>
          </button>
        </li> -->
        <li class="nav-item mt-2">
          <button class="gradient-button w-100">
            <i class="fa fa-sign-out-alt"></i>
          <a href="{% url 'logout' %}" class="fix"> Log Out</a><br>
          </button>
        </li>
      </ul>

      <div class="sidebar-footer">
        <img src="{% static 'core/images/rb_2149331949.png' %}" alt="Sidebar Art">
      </div>
    </div>

    <!-- ======================= -->
    <!-- ====== CONTENT ======= -->
    <!-- ======================= -->
    <div class="content">

      <!-- ===== WELCOME BOX ===== -->
      <div class="welcome-container d-flex align-items-center mb-4">
        <!-- Left: Illustration -->
        <div class="image-container me-4">
          <!-- <img src="{% static 'core/images/rb_2148892786.png' %}" -->
               <!-- alt="Profile Picture"
               width="390"
               height="190"> -->
        </div>
        <!-- Right: Welcome Card -->
        <div class="welcome-box flex-fill">
          <h1 style="font-size: 1.2rem; margin-bottom: 5px;">
             Welcome, {{ user.get_full_name|default:user.username }}<br>
  Qualification: <strong>{{ qualification.name }}</strong>
          </h1>
          <div class="date mb-3">
            Below is an overview of submitted assessments and their current moderation status.
          </div>
          <button class="gradient-button">
            Innovating for Impact
          </button>
        </div>
      </div>

      <!-- ===== UPLOAD / GENERATE BUTTONS ===== -->
      <div class="upload-section d-flex mb-4">
        
        <a href="{% url 'generate_tool_page' %}" class="gradient-button">
          Generate EISA Tool
        </a>
      </div>

      <!-- ===== ASSESSMENT TABLE ===== -->
      <section class="master mt-4">
        <h2 class="mb-3" style="text-align: center;">Assessment Tracking Overview</h2>
        <table class="assessment-table w-100">
          <thead>
            <tr>
              <th>EISA ID</th>
              <th>Qualification</th>
              <th>Paper No.</th>
              <th>Moderator details</th>
              <th>Status</th>
              <th>QCTO Comments</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for assessment in assessments %}
            <tr>
              <td>{{ assessment.eisa_id|default:"N/A" }}</td>
              <td>{{ assessment.qualification }}</td>
              <td>{{ assessment.paper }}</td>
              <td>
                {% if assessment.moderator %}
                  {{ assessment.moderator.get_full_name|default:assessment.moderator.email }}
                {% else %}
                  –
                {% endif %}
              </td>
              <td class="status-{{ assessment.status|slugify }}">
                {{ assessment.status }}
              </td>
              <td>{{ assessment.qcto_notes|default:"—" }}</td>
              <td>
                {% if assessment.eisa_id %}
                  <a href="{% url 'view_assessment' assessment.eisa_id %}"
                     class="gradient-button small">
                    View
                  </a>
                {% else %}
                  <span class="text-muted fst-italic">No ID Available</span>
                {% endif %}
              </td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="7" class="text-center">No assessments found.</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </section>
    </div>

  </div> <!-- /.dashboard-container -->


  <script src="{% static 'core/js/assessor_dashboard.js' %}"></script>
</body>
</html>
